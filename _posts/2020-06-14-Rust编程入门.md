---

layout:     post
title:      Rust ç¼–ç¨‹å…¥é—¨
subtitle:   èœé¸Ÿå…¥é—¨ rust
date:       2020-06-14
author:     Jerry Chen
header-img: img/post-bg-debug.png
catalog: true
tags:
    - rust
---

### èµ„æ–™

[ã€ŠRust ç¨‹åºè®¾è®¡è¯­è¨€ ç¬¬äºŒç‰ˆã€‹](https://kaisery.gitbooks.io/trpl-zh-cn/content/) 

### å¸¸è§ç¼–ç¨‹æ¦‚å¿µ

#### å˜é‡

##### å˜é‡ä¸å¯å˜

```
fn main() {
    let x = 5;
    println!("x is {}", x);
    x = 6; //æŠ¥é”™ï¼Œå› ä¸º x é»˜è®¤ä¸å¯å˜
}
```

##### å˜é‡å¯å˜

```
fn main() {
    let mut x = 5;
    println!("x is {}", x);
    x = 6; //x å¯å˜
    println!("x is {}", x);
}
```

##### å˜é‡éšè—

> ä¸Šä¸€ä¸ªåŒå x å˜é‡è¢«éšè—äº†ï¼›
>
> ä½¿ç”¨ let å°±ä¼šåˆ›å»ºæ–°å˜é‡ï¼›

```
fn main() {
    let x = 5;
    println!("x is {}", x);
    let x: String = "hello".parse().expect("Not a string!");
    println!("x is {}", x);
}
```

#### å¸¸é‡

```
const MAX_POINTS: u32 = 100_000;

fn main() {
    println!("MAX_POINTS is {}", MAX_POINTS);
}
```

#### ç±»å‹

##### æ•´å‹

> arch è¡¨ç¤ºç³»ç»Ÿä½æ•°ï¼Œæ¯”å¦‚ 64-bitï¼›

| é•¿åº¦    | æœ‰ç¬¦å·  | æ— ç¬¦å·  |
| ------- | ------- | ------- |
| 8-bit   | `i8`    | `u8`    |
| 16-bit  | `i16`   | `u16`   |
| 32-bit  | `i32`   | `u32`   |
| 64-bit  | `i64`   | `u64`   |
| 128-bit | `i128`  | `u128`  |
| arch    | `isize` | `usize` |

```
fn main() {
    let x: i32 = -118;
    println!("x is {}", x);
    println!("max is {}", usize::max_value());
}
```

##### æµ®ç‚¹å‹

| é•¿åº¦   | æµ®ç‚¹ |
| ------ | ---- |
| 32-bit | f32  |
| 64-bit | f64  |

```
fn main() {
    // åŠ æ³•
    let sum: i32 = 5 + 10; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£
    println!("sum is {}", sum);
    // å‡æ³•
    let difference: f32 = 95.5 - 4.3; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£
    println!("difference is {}", difference);
    // ä¹˜æ³•
    let product = 4 * 30;
    println!("product is {}", product);
    // é™¤æ³•
    let quotient = 56.7 / 32.2;
    println!("quotient is {}", quotient);
    // å–ä½™
    let remainder = 43 % 5;
    println!("remainder is {}", remainder);
}
```

##### å¸ƒå°”ç±»å‹

Rust ä¸­çš„å¸ƒå°”ç±»å‹ï¼ˆboolï¼‰æœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼š`true` å’Œ `false`ï¼›

```
fn main() {
    let t = true;
    let f: bool = false; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£
    println!("t is {}", t);
    println!("f is {}", f);
}
```

##### å­—ç¬¦ç±»å‹

Rust çš„ `char` ç±»å‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚(four bytes)ï¼›

```
fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£
    let heart_eyed_cat = 'ğŸ˜»';
    println!("c is {}", c);
    println!("z is {}", z);
    println!("heart_eyed_cat is {}", heart_eyed_cat);
}
```

##### æ•°ç»„ç±»å‹

```
fn main() {
    let a = [1, 2, 3, 4, 5];
    println!("a[0] is {}", a[0]);
    let a: [i32; 5] = [1, 2, 3, 4, 5]; // æ˜¾å¼æŒ‡å®šç±»å‹æ³¨è§£
    println!("a[4] is {}", a[4]);

    let first = a[0];
    let second = a[1];
    let [x, y, z, m, n] = a; //è§£æ„æ•°ç»„
    println!("first is {}", first);
    println!("n is {}", n);
}
```

##### å…ƒç»„ç±»å‹

```
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);
    println!("x.0 is {}", x.0);

    let five_hundred = x.0;
    let six_point_four = x.1;
    let one = x.2;
    let (m, n, z) = x; //è§£æ„å…ƒç»„
    println!("z is {}", z);
}
```

#### å‡½æ•°

##### æ— å‚æ•°æ— è¿”å›å€¼

> Rust ä¸å…³å¿ƒå‡½æ•°å®šä¹‰äºä½•å¤„ï¼Œåªè¦å®šä¹‰äº†å°±è¡Œï¼›

```
fn main() {
    println!("Hello, world!");
    another_function();
}

fn another_function() {
    println!("Another function.");
}
```

##### æœ‰å‚æ•°æ— è¿”å›å€¼

```
fn main() {
    another_function(5);
}

fn another_function(x: i32) {
    println!("x is {}", x);
}
```

##### è¡¨è¾¾å¼

> ä½¿ç”¨ {} åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼Œæœ€ç»ˆç»“æœæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼›

```
fn main() {
    let x = 5;
    let y = {
        let x = 3;
        x + 1
    };
    println!("y is {}", y);
}
```

##### æ— å‚æ•°æœ‰è¿”å›å€¼

```
fn five() -> i32 {
    5
}

fn main() {
    let x = five();
    println!("x is {}", x);
}
```

##### æœ‰å‚æ•°æœ‰è¿”å›å€¼

```
fn main() {
    let x = plus_one(5);
    println!("x is {}", x);
}

fn plus_one(x: i32) -> i32 {
    x + 1
}
```

å…¶ä»–è¿”å›å€¼å†™æ³•ï¼š

```
fn plus_one(x: i32) -> i32 {
    return x + 1;
}
```

#### æ³¨é‡Š

```
// hello, world
```

#### æ§åˆ¶æµ

##### if

```
fn main() {
    let num = 3;
    if num != 0 {
        println!("condition was true!");
    }
}
```

##### if-else

```
fn main() {
    let num = 3;
    if num < 5 {
        println!("condition was true!");
    } else {
        println!("condition was false");
    }
}
```

##### if-eles if-else

```
fn main() {
    let num = 6;
    if num % 4 == 0 {
        println!("num is divisible by 4");
    } else if num % 3 == 0 {
        println!("num is divisible by 3");
    } else if num % 2 == 0 {
        println!("num is divisible by 2");
    } else {
        println!("num is not divisible by 4, 3, or 2");
    }
}
```

##### let-if

```
fn main() {
    let condition = true;
    let num = if condition {
        5
    } else {
        6
    };
    println!("num is {}", num);
}
```

##### loop

```
fn main() {
    loop { //æ­»å¾ªç¯
        println!("again!");
    }
}
```

```
fn main() {
    let mut counter = 0;
    let result = loop {
        counter += 1;
        if counter == 10 {
            break counter * 2; //æ‰“æ–­ loop
        }
    };
    println!("result is {}", result);
}
```

##### while

```
fn main() {
    let mut num = 3;
    while num != 0 {
        println!("{}!", num);
        num = num -1;
    }
    println!("LIFTOFF!!!");
}
```

```
fn main() {
    let a = [10, 20, 30, 40, 50];
    let mut index = 0;
    while index < 5 {
        println!("the value is {}", a[index]);
        index += 1;
    }
    println!("LIFTOFF!!!");
}
```

##### for

```
fn main() {
    let a = [10, 20, 30, 40, 50];
    for element in a.iter() {
        println!("the value is {}", element);
    }
    println!("LIFTOFF!!!");
}
```

```
fn main() {
    //ä» 1 åˆ°æ•°å­— 4 å¼€å§‹ä¹‹å‰
    //rev() æ˜¯åè½¬
    for num in (1..4).rev() {
        println!("{}!", num);
    }
    println!("LIFTOFF!!!");
}
```

### çŒœæ•°å­—æ¸¸æˆ

#### main.rs

```
use std::io;
use std::cmp::Ordering;
use rand::Rng;

fn main() {
    println!("Guess the number!");

    let secret_number = rand::thread_rng().gen_range(1, 101);

    loop {
        println!("Please input your guess.");

        let mut guess = String::new();

        io::stdin().read_line(&mut guess)
            .expect("Failed to read line");

        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => continue,
        };

        println!("You guessed: {}", guess);

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            }
        }
    }
}
```

#### cargo.toml

```
[package]
name = "hello"
version = "0.1.0"
authors = ["xvera"]
edition = "2018"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
rand = "0.5.5"
```

